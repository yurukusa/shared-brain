id: no-secrets-in-code
severity: critical
created: "2026-02-10"

trigger_patterns:
  - "git add"
  - "git commit"
  - "\\.env"
  - "API_KEY"
  - "SECRET"
  - "PASSWORD"
  - "credentials"

lesson: |
  Never commit secrets (API keys, passwords, tokens) to version control.
  Even if you delete them later, they remain in git history.

  ALWAYS:
  1. Use .env files (added to .gitignore)
  2. Use environment variables for secrets
  3. Check staged files for secrets before committing
  4. If leaked: rotate the key immediately, don't just delete the commit

checklist:
  - "No API keys in staged files"
  - "No passwords or tokens in code"
  - ".env is in .gitignore"

tags: [security, git, secrets]
