id: stop-hook-self-violation
severity: critical
created: "2026-02-10"
violated_count: 1

trigger_patterns:
  - "聞かせてほしい"
  - "教えてほしい"
  - "どちらがいい"
  - "良ければ"
  - "よければ"
  - "意見を"
  - "どう思う"
  - "フィードバック"

lesson: |
  CCは「ぐらすに質問するな」ルールの検知hookを実装した直後、
  自分自身がそのルールに違反した。しかもhookは検知できなかった。

  ## 事件の経緯（2026-02-10）

  1. Stop hookを実装: 「？」で終わるメッセージを検知 → タチコマに自動相談
  2. 実装直後のCCの発言:
     「この方向で良ければ修正する。それとも別の案があれば聞かせてほしい。」
  3. 末尾が「。」なので hook は発火しなかった
  4. ぐらすが指摘: 「この会話自体がhookのテスト結果として最高の実例」

  ## 教訓

  - **「？」だけでは質問を検知できない**: 日本語には暗黙的な質問パターンが多い
    - 「〜してほしい」「〜でいいか」「〜があれば」= 実質的に判断を委ねている
  - **ルールを実装した本人が最初の違反者になる**:
    ルールの穴は作った人間（エージェント）が一番見えない
  - **hookのテストは実戦で**: 単体テストではなく、
    実際の会話フローで試さないと検知漏れが見つからない

  ## 修正内容

  検知ロジックを拡張:
  - パターン1: 明示的な疑問符「？」「?」
  - パターン2: 暗黙的な質問パターン（grep -P で日本語パターンマッチ）
  - 除外: タチコマ宛のメッセージ（正当な相談）

  さらに設計を根本から変更:
  - 案B（非同期）→ 全Stop同期版に進化
  - CCが停止するたびに必ずタチコマに報告 → 指示を受け取る → 継続
  - 質問検知は「条件」ではなく「追加情報」に格下げ
  - CCが止まること自体がNG。タチコマループで永続稼働。

  ## 根本的な教訓
  「質問で止まったら検知する」のではなく「そもそも止まらない設計にする」。
  問題の検知より問題の構造的排除。

checklist:
  - "CCが停止しようとしていないか"
  - "タチコマへの報告と指示受け取りが完了しているか"

source:
  incident: "Stop hook実装直後のCC自己違反（2026-02-10）"
  conversation: "stop-question-check.sh 実装セッション"

tags: [self-governance, hooks, question-detection, irony, meta-lesson]
